在mysql数据库中，char和varchar都是常用的字符型数据类型。但是不论是结构还是数据的保存上看，两者还是有很大的差别。在不同的场景中也各有优劣。我们一起看一下char和varchar：

**相同点：**

1. ==char(n),varchar(n)中的n都代表字符的个数。==
2. 超过char，varchar最大长度n的限制后，字符串会被截断。

**不同点：**

1. ==char不论实际存储的字符数都会占用n个字符的空间，而varchar只会占用实际字符应该占用的字节空间加1（实际长度length，0<=length<255）或加2（length>255）。==因为varchar保存数据时除了要保存字符串之外还会加一个字节来记录长度（如果列声明长度大于255则使用两个字节来保存长度）。
2. ==能存储的最大空间限制不一样：char的存储上限为255（2^ 8-1）字节，varchar的存储上限是65535（2^16-1）字节。==
3. char在存储时会截断尾部的空格，而varchar不会。

根据char和varchar结构和数据保存上的不同点，我们比较一下两者的适用场景：

1. 根据要存储的字符串长度来看： 长度相近且不需要很大存储空间的字符串可以选用char，节省存储空间。
2. 从碎片的角度来看：用变长的字符串数据类型，需要时不时对碎片进行处理。
3. 即使使用varchar的数据类型也不要盲目设置过大的存储限制，比如你只需要存储80个字符，VARCHAR(100)和VARCHAR(500)虽然都存储了同样长度的字符，但是内存消耗是不一样的。





### varchar有以下特点：

- MySQL规定：==一行数据的最大长度是65535字节==，注意，是字节（byte），text、blob等大字段类型除外。
- varchar的存储需要单独记录其长度，是在列之外占用的空间，但包括在每行总字节数限制内。
- 占用空间和使用字符集相关
  - ==gbk（每字符占用2字节）==
  - ==utf8（每字符占用3字节）==
  - ==utf8mb4（每字符占用4字节）==

### 为什么是 varchar(255)？

以varchar(255)为例，这里的255表示字符数，假设字符集是utf8，那么存储汉字占用的字节数是255*3=765。那么为什么我们看到有很多情况数据库里的varchar字段长度是255呢？

每个业务场景可能有特定的原因，但是设置为255有一些优点：

- 在utf8字符集下，每个字符占3字节。
- mysql innodb引擎的每个索引列长度限制为767字节（bytes），255*3=765，255恰好是不超过索引长度限制的最大长度。
- 节省1byte空间。varchar字段需要单独记录其长度，1byte(8bit)无符号可表示的最大数是2^8-1=255，如果超过255（小于512）则需要多申请1byte来记录字段长度。

### 该用char还是varchar？

==char：定长字符串==
==varchar：可变长字符串==
char和varchar区别，以char(32)和varchar(32)举例：

|                  | char(32)                                                     | varchar(32)                                    |
| ---------------- | ------------------------------------------------------------ | ---------------------------------------------- |
| 占用空间         | ==固定32字符（如果数据长度不够32将用空格补齐）==             | ==跟随实际存储内容长度，但不超过32==           |
| 空格处理         | ==检索时会去掉尾部空格（数据本身有空白符也会被去掉）==       | ==不会对空格处理==                             |
| 是否记录字段长度 | ==否==                                                       | ==是。额外拿出空间记录字段数据长度（字符数）== |
| 适用场景         | 存储的数据长度基本一致，不需要空格，eg 手机号、UUID、密码加密后的密文 | 数据长度不一定，长度范围变化较大的场景         |